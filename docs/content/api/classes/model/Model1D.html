<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Model1D &mdash; GeoBIPy 1.0.0 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery-rendered-html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Pointcloud classes" href="../pointcloud/pointcloud.html" />
    <link rel="prev" title="Model" href="Model_.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html" class="icon icon-home"> GeoBIPy
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../base/base.html">Core routines needed for GeoBIPy</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../classes.html">Classes used in GeoBIPy</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../core/core.html">Core classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/data.html">Data classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mesh/mesh.html">Mesh classes</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="model.html">Model classes</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="Model_.html">Model</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Model1D</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../pointcloud/pointcloud.html">Pointcloud classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statistics/statistics.html">Statistics classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../system/system.html">System classes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../examples/index.html">Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">GeoBIPy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../api.html">API</a></li>
          <li class="breadcrumb-item"><a href="../classes.html">Classes used in GeoBIPy</a></li>
          <li class="breadcrumb-item"><a href="model.html">Model classes</a></li>
      <li class="breadcrumb-item active">Model1D</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/content/api/classes/model/Model1D.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="model1d">
<h1>Model1D<a class="headerlink" href="#model1d" title="Permalink to this heading"></a></h1>
<div class="graphviz"><img src="../../../../_images/inheritance-2964d723654692d1349c3546d2e7cea7ca4086fd.png" alt="Inheritance diagram of geobipy.src.classes.model.Model1D" usemap="#inheritance0303cabe1d" class="inheritance graphviz" /></div>
<map id="inheritance0303cabe1d" name="inheritance0303cabe1d">
<area shape="rect" id="node3" href="../core/myObject.html#geobipy.src.classes.core.myObject.myObject" target="_top" title="Abstract base class" alt="" coords="125,5,204,31"/>
<area shape="rect" id="node5" href="../mesh/RectilinearMesh1D.html#geobipy.src.classes.mesh.RectilinearMesh1D.RectilinearMesh1D" target="_top" title="Class defining a 1D rectilinear mesh with cell centres and edges." alt="" coords="372,5,505,31"/>
<area shape="rect" id="node4" href="#geobipy.src.classes.model.Model1D.Model1D" target="_top" title="Class extension to geobipy.Model" alt="" coords="553,5,628,31"/>
</map><span class="target" id="module-geobipy.src.classes.model.Model1D"></span><p>&#64;Model1D_Class
Module describing a 1 Dimensional layered Model</p>
<dl class="py class">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geobipy.src.classes.model.Model1D.</span></span><span class="sig-name descname"><span class="pre">Model1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">widths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relativeTo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D" title="Permalink to this definition"></a></dt>
<dd><p>Class extension to geobipy.Model</p>
<p>Class creates a representation of the 1D layered earth.
The class contains parameters that describe the physical property of each layer, as well as the layer
thicknesses and interface depths. The model maintains a half space as the lowest layer with infinite extent.
This class allows a probability wheel to be assigned such that the 1D layered earth can be peturbed. i.e.
randomly create, delete, or perturb the layers in the model.  This is a key step in a Markov Chain for Bayesian inference.</p>
<p>Model1D(nCells, top, parameters, edges, widths)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nCells</strong> (<em>int</em>) – Number of layers in the 1D layered earth. A single layer represents a half space.</p></li>
<li><p><strong>top</strong> (<em>numpy.float64</em><em>, </em><em>optional</em>) – Depth to the top of the model</p></li>
<li><p><strong>parameters</strong> (<em>geobipy.StatArray</em><em>, </em><em>optional</em>) – Describes the variable within each layer of the model.</p></li>
<li><p><strong>depth</strong> (<em>geobipy.StatArray</em><em>, </em><em>optional</em>) – Depths to the lower interface of each layer above the halfspace. Do not provide if thickness is given.</p></li>
<li><p><strong>thickness</strong> (<em>geobipy.StatArray</em><em>, </em><em>optional</em>) – Thickness of each layer above the halfspace. Do not provide if depths are given.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – 1D layered earth model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#geobipy.src.classes.model.Model1D.Model1D" title="geobipy.src.classes.model.Model1D.Model1D">Model1D</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If nCells is &lt;= 0</p></li>
<li><p><strong>ValueError</strong> – If size(parameters) != nCells</p></li>
<li><p><strong>ValueError</strong> – If size(depth) != nCells - 1</p></li>
<li><p><strong>ValueError</strong> – If size(thickness) != nCells - 1</p></li>
<li><p><strong>TypeError</strong> – If both depth and thickness are provided</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.asHistogram2D">
<span class="sig-name descname"><span class="pre">asHistogram2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hist</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.asHistogram2D" title="Permalink to this definition"></a></dt>
<dd><p>Creates a Hitmap from the model given the variance of each layer.</p>
<p>For each depth, creates a normal distribution with a mean equal to the interpolated parameter
at that depth and variance specified with variance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variance</strong> (<em>array_like</em>) – The variance of each layer</p></li>
<li><p><strong>Hitmap</strong> (<em>geobipy.Hitmap</em>) – Hitmap to convert the model to.
Must be instantiated before calling so that the model can be interpolated correctly</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.compute_local_inverse_hessian">
<span class="sig-name descname"><span class="pre">compute_local_inverse_hessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataPoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.compute_local_inverse_hessian" title="Permalink to this definition"></a></dt>
<dd><p>Generate a localized Hessian matrix using
a dataPoint and the current realization of the Model1D.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataPoint</strong> (<em>geobipy.DataPoint</em><em>, </em><em>optional</em>) – The data point to use when computing the local estimate of the variance.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – Hessian matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.createHdf">
<span class="sig-name descname"><span class="pre">createHdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">withPosterior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillvalue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.createHdf" title="Permalink to this definition"></a></dt>
<dd><p>Create the Metadata for a Model1D in a HDF file</p>
<p>Creates a new group in a HDF file under h5obj.
A nested heirarchy will be created.
This method can be used in an MPI parallel environment, if so however,
a) the hdf file must have been opened with the mpio driver, and
b) createHdf must be called collectively,
i.e., called by every core in the MPI communicator that was used to open the file.
In order to create large amounts of empty space before writing to it in parallel,
the add_axis parameter will extend the memory in the first dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h5obj</strong> (<em>h5py._hl.files.File</em><em> or </em><em>h5py._hl.group.Group</em>) – A HDF file or group object to create the contents in.</p></li>
<li><p><strong>name</strong> (<em>str</em>) – The name of the group to create.</p></li>
<li><p><strong>add_axis</strong> (<em>int</em><em>, </em><em>optional</em>) – Inserts a first dimension into the first dimension of each attribute of the Model1D of length add_axis.
This can be used to extend the available memory of the Model1D so that multiple MPI ranks can write to
their respective parts in the extended memory.</p></li>
<li><p><strong>fillvalue</strong> (<em>number</em><em>, </em><em>optional</em>) – Initializes the memory in file with the fill value</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method can be used in serial and MPI. As an example in MPI.
Given 10 MPI ranks, each with a 10 length array, it is faster to create a 10x10 empty array,
and have each rank write its row. Rather than creating 10 separate length 10 arrays because
the overhead when creating the file metadata can become very cumbersome if done too many times.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">geobipy</span> <span class="kn">import</span> <span class="n">Model1D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpi4py</span> <span class="kn">import</span> <span class="n">MPI</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">world</span> <span class="o">=</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a holder for models in memory with more layers than you will expect.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp</span> <span class="o">=</span> <span class="n">Model1D</span><span class="p">(</span><span class="n">nCells</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># This is a collective open of data in the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s1">&#39;mpio&#39;</span><span class="p">,</span><span class="n">comm</span><span class="o">=</span><span class="n">world</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Collective creation of space(padded by number of mpi ranks)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp</span><span class="o">.</span><span class="n">createHdf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="n">add_axis</span><span class="o">=</span><span class="n">world</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">world</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># In a non collective region, we can write to different sections of x in the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fake a non collective region</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">noncollectivewrite</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Each rank carries out this code, but it&#39;s not collective.</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">model</span><span class="o">.</span><span class="n">writeHdf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;models&#39;</span><span class="p">,</span>  <span class="n">index</span><span class="o">=</span><span class="n">world</span><span class="o">.</span><span class="n">rank</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noncollectivewrite</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">world</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">world</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.delete_edge">
<span class="sig-name descname"><span class="pre">delete_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_priors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.delete_edge" title="Permalink to this definition"></a></dt>
<dd><p>Remove an edge from the model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>i</strong> (<em>int</em>) – The edge to remove.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>out</strong> (<em>geobipy.Model1D</em>) – Model with layer removed.</p></li>
<li><p><strong>update_priors</strong> (<em>bool, optional</em>) – If priors are attached, update their dimension to match</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.evaluateHitmapPrior">
<span class="sig-name descname"><span class="pre">evaluateHitmapPrior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Hitmap</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.evaluateHitmapPrior" title="Permalink to this definition"></a></dt>
<dd><p>Evaluates the model parameters against a hitmap.</p>
<p>Given a Hitmap describing the probability of the parameters with depth, evaluate the current model using the grid cells it passes through.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Hitmap</strong> (<em>geobipy.Hitmap</em>) – A 2D hitmap with y axis depth, and x axis parameter to evaluate the probability of the model given the hitmap</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – The probability of the model given the hitmap.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.float64</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.fromHdf">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fromHdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.fromHdf" title="Permalink to this definition"></a></dt>
<dd><p>Read the class from a HDF group</p>
<p>Given the HDF group object, read the contents into an Model1D class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h5obj</strong> (<em>h5py._hl.group.Group</em>) – A HDF group object to write the contents to.</p></li>
<li><p><strong>index</strong> (<em>slice</em><em>, </em><em>optional</em>) – If the group was created using the nRepeats option, index specifies the index’th entry from which to read the data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.gradientProbability">
<span class="sig-name descname"><span class="pre">gradientProbability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.gradientProbability" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the prior for the gradient of the parameter with depth</p>
<p><strong>Prior on the gradient of the physical parameter with depth</strong></p>
<p>If instead we wish to apply a multivariate normal distribution to the gradient of the parameter with depth we get</p>
<div class="math notranslate nohighlight" id="equation-gradient1">
<span class="eqno">(1)<a class="headerlink" href="#equation-gradient1" title="Permalink to this equation"></a></span>\[p(\boldsymbol{\sigma} | k, I) = \left[(2\pi)^{k-1} |\boldsymbol{C}_{\nabla_{z}}|\right]^{-\frac{1}{2}} e ^{-\frac{1}{2}(\nabla_{z} \boldsymbol{\sigma})^{T} \boldsymbol{C}_{\nabla_{z}}^{-1} (\nabla_{z}\boldsymbol{\sigma})}\]</div>
<p>where the parameter gradient <span class="math notranslate nohighlight">\(\nabla_{z}\sigma\)</span> at the ith layer is computed via</p>
<div class="math notranslate nohighlight" id="equation-dpdz1">
<span class="eqno">(2)<a class="headerlink" href="#equation-dpdz1" title="Permalink to this equation"></a></span>\[\nabla_{z}^{i}\sigma = \frac{\sigma_{i+1} - \sigma_{i}}{h_{i} - h_{min}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma_{i+1}\)</span> and <span class="math notranslate nohighlight">\(\sigma_{i}\)</span> are the log-parameters on either side of an interface, <span class="math notranslate nohighlight">\(h_{i}\)</span> is the log-thickness of the ith layer, and <span class="math notranslate nohighlight">\(h_{min}\)</span> is the minimum log thickness defined by</p>
<div class="math notranslate nohighlight" id="equation-minthickness1">
<span class="eqno">(3)<a class="headerlink" href="#equation-minthickness1" title="Permalink to this equation"></a></span>\[h_{min} = \frac{z_{max} - z_{min}}{2 k_{max}}\]</div>
<p>where <span class="math notranslate nohighlight">\(k_{max}\)</span> is a maximum number of layers, set to be far greater than the expected final solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hmin</strong> (<em>float64</em>) – The minimum thickness of any layer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – The probability given the prior on the gradient of the parameters with depth.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.float64</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.init_posterior_plots">
<span class="sig-name descname"><span class="pre">init_posterior_plots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.init_posterior_plots" title="Permalink to this definition"></a></dt>
<dd><p>Initialize axes for posterior plots</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gs</strong> (<em>matplotlib.gridspec.Gridspec</em>) – Gridspec to split</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.insert_edge">
<span class="sig-name descname"><span class="pre">insert_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_priors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.insert_edge" title="Permalink to this definition"></a></dt>
<dd><p>Insert a new edge into a model at a given location</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>numpy.float64</em>) – Location at which to insert a new edge</p></li>
<li><p><strong>par</strong> (<em>numpy.float64</em><em>, </em><em>optional</em>) – Value of the parameter for the new layer
If None, The value of the split layer is duplicated.</p></li>
<li><p><strong>update_priors</strong> (<em>bool</em><em>, </em><em>optional</em>) – If priors are attached, update their dimension to match</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – Model with inserted layer.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>geobipy.Model1D</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.isInsideConfidence">
<span class="sig-name descname"><span class="pre">isInsideConfidence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">histogram2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">95.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.isInsideConfidence" title="Permalink to this definition"></a></dt>
<dd><p>Check that the model is insde the specified confidence region of a 2D hitmap</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>histogram2d</strong> (<em>geobipy.Histogram</em>) – The hitmap to check against.</p></li>
<li><p><strong>percent</strong> (<em>np.float</em><em>, </em><em>optional</em>) – The confidence interval percentage.</p></li>
<li><p><strong>log</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to take the parameters to a log base (log).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – All parameter values are within the confidence intervals.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.localParameterVariance">
<span class="sig-name descname"><span class="pre">localParameterVariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datapoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.localParameterVariance" title="Permalink to this definition"></a></dt>
<dd><p>Generate a localized inverse Hessian matrix using a dataPoint and the current realization of the Model1D.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>datapoint</strong> (<em>geobipy.DataPoint</em><em>, </em><em>optional</em>) – The data point to use when computing the local estimate of the variance.
If None, only the prior derivative is used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – Inverse Hessian matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.pad">
<span class="sig-name descname"><span class="pre">pad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.pad" title="Permalink to this definition"></a></dt>
<dd><p>Copies the properties of a model including all priors or proposals, but pads memory to the given size</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>size</strong> (<em>int</em>) – Create memory upto this size.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – Padded model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>geobipy.Model1D</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.pcolor">
<span class="sig-name descname"><span class="pre">pcolor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.pcolor" title="Permalink to this definition"></a></dt>
<dd><p>Create a pseudocolour plot of the 1D Model.</p>
<p>Can take any other matplotlib arguments and keyword arguments e.g. cmap etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> (<em>scalar</em><em> or </em><em>array_like</em><em>, </em><em>optional</em>) – If alpha is scalar, behaves like standard matplotlib alpha and opacity is applied to entire plot
If array_like, each pixel is given an individual alpha value.</p></li>
<li><p><strong>log</strong> (<em>'e'</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – Take the log of the colour to a base. ‘e’ if log = ‘e’, and a number e.g. log = 10.
Values in c that are &lt;= 0 are masked.</p></li>
<li><p><strong>equalize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Equalize the histogram of the colourmap so that all colours have an equal amount.</p></li>
<li><p><strong>nbins</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of bins to use for histogram equalization.</p></li>
<li><p><strong>xscale</strong> (<em>str</em><em>, </em><em>optional</em>) – Scale the x axis? e.g. xscale = ‘linear’ or ‘log’</p></li>
<li><p><strong>yscale</strong> (<em>str</em><em>, </em><em>optional</em>) – Scale the y axis? e.g. yscale = ‘linear’ or ‘log’.</p></li>
<li><p><strong>flipX</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flip the X axis</p></li>
<li><p><strong>flipY</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flip the Y axis</p></li>
<li><p><strong>grid</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot the grid</p></li>
<li><p><strong>noColorbar</strong> (<em>bool</em><em>, </em><em>optional</em>) – Turn off the colour bar, useful if multiple plotting plotting routines are used on the same figure.</p></li>
<li><p><strong>trim</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set the x and y limits to the first and last non zero values along each axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>matplotlib.Axes</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ax</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">matplotlib.pyplot.pcolormesh</span></code></dt><dd><p>For additional keyword arguments you may use.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.perturb">
<span class="sig-name descname"><span class="pre">perturb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datapoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.perturb" title="Permalink to this definition"></a></dt>
<dd><p>Perturb a model’s structure and parameter values.</p>
<p>Uses a stochastic newtown approach if a datapoint is provided.
Otherwise, uses the existing proposal distribution attached to
self.par to generate new values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataPoint</strong> (<em>geobipy.DataPoint</em><em>, </em><em>optional</em>) – The datapoint to use to perturb using a stochastic Newton approach.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>remappedModel</strong> (<em>geobipy.Model1D</em>) – The current model remapped onto the perturbed dimension.</p></li>
<li><p><strong>perturbedModel</strong> (<em>geobipy.Model1D</em>) – The model with perturbed structure and parameter values.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plots a 1D model parameters as a line against depth</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reciprocateX</strong> (<em>bool</em><em>, </em><em>optional</em>) – Take the reciprocal of the x axis</p></li>
<li><p><strong>xscale</strong> (<em>str</em><em>, </em><em>optional</em>) – Scale the x axis? e.g. xscale = ‘linear’ or ‘log’</p></li>
<li><p><strong>yscale</strong> (<em>str</em><em>, </em><em>optional</em>) – Scale the y axis? e.g. yscale = ‘linear’ or ‘log’</p></li>
<li><p><strong>flipX</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flip the X axis</p></li>
<li><p><strong>flipY</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flip the Y axis</p></li>
<li><p><strong>noLabels</strong> (<em>bool</em><em>, </em><em>optional</em>) – Do not plot the labels</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.priorProbability">
<span class="sig-name descname"><span class="pre">priorProbability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pPrior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gPrior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.priorProbability" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the prior probability for the 1D Model.</p>
<p>The following equation describes the components of the prior that correspond to the Model1D,</p>
<div class="math notranslate nohighlight">
\[p(k | I)p(\boldsymbol{z}| k, I)p(\boldsymbol{\sigma} | k, \boldsymbol{z}, I),\]</div>
<p>where <span class="math notranslate nohighlight">\(k, I, \boldsymbol{z}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{\sigma}\)</span> are the number of layers, prior information, interface depth, and physical property, respectively.</p>
<p>The multiplication here can be turned into a summation by taking the log of the components.</p>
<p><strong>Prior on the number of layers</strong></p>
<p>Uninformative prior using a uniform distribution.</p>
<div class="math notranslate nohighlight" id="equation-layers">
<span class="eqno">(4)<a class="headerlink" href="#equation-layers" title="Permalink to this equation"></a></span>\[p(k | I) =
\begin{cases}
\frac{1}{k_{max} - 1} &amp; \quad 1 \leq k \leq k_{max} \newline
0 &amp; \quad otherwise
\end{cases}.\]</div>
<p><strong>Prior on the layer interface depths</strong></p>
<p>We use order statistics for the prior on layer depth interfaces.</p>
<div class="math notranslate nohighlight" id="equation-depth">
<span class="eqno">(5)<a class="headerlink" href="#equation-depth" title="Permalink to this equation"></a></span>\[p(\boldsymbol{z} | k, I) = \frac{(k -1)!}{\prod_{i=0}^{k-1} \Delta z_{i}},\]</div>
<p>where the numerator describes the number of ways that <span class="math notranslate nohighlight">\((k - 1)\)</span> interfaces can be ordered and
<span class="math notranslate nohighlight">\(\Delta z_{i} = (z_{max} - z_{min}) - 2 i h_{min}\)</span> describes the depth interval that is available to place a layer when there are already i interfaces in the model</p>
<p><strong>Prior on the physical parameter</strong></p>
<p>If we use a multivariate normal distribution to describe the joint prior pdf for log-parameter values in all layers we use,</p>
<div class="math notranslate nohighlight" id="equation-parameter">
<span class="eqno">(6)<a class="headerlink" href="#equation-parameter" title="Permalink to this equation"></a></span>\[p(\boldsymbol{\sigma} | k, I) = \left[(2\pi)^{k} |\boldsymbol{C}_{\boldsymbol{\sigma}0}|\right]^{-\frac{1}{2}} e ^{-\frac{1}{2}(\boldsymbol{\sigma} - \boldsymbol{\sigma}_{0})^{T} \boldsymbol{C}_{\boldsymbol{\sigma} 0}^{-1} (\boldsymbol{\sigma} - \boldsymbol{\sigma}_{0})}\]</div>
<p><strong>Prior on the gradient of the physical parameter with depth</strong></p>
<p>If instead we wish to apply a multivariate normal distribution to the gradient of the parameter with depth we get</p>
<div class="math notranslate nohighlight" id="equation-gradient">
<span class="eqno">(7)<a class="headerlink" href="#equation-gradient" title="Permalink to this equation"></a></span>\[p(\boldsymbol{\sigma} | k, I) = \left[(2\pi)^{k-1} |\boldsymbol{C}_{\nabla_{z}}|\right]^{-\frac{1}{2}} e ^{-\frac{1}{2}(\nabla_{z} \boldsymbol{\sigma})^{T} \boldsymbol{C}_{\nabla_{z}}^{-1} (\nabla_{z}\boldsymbol{\sigma})}\]</div>
<p>where the parameter gradient <span class="math notranslate nohighlight">\(\nabla_{z}\sigma\)</span> at the ith layer is computed via</p>
<div class="math notranslate nohighlight" id="equation-dpdz">
<span class="eqno">(8)<a class="headerlink" href="#equation-dpdz" title="Permalink to this equation"></a></span>\[\nabla_{z}^{i}\sigma = \frac{\sigma_{i+1} - \sigma_{i}}{h_{i} - h_{min}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma_{i+1}\)</span> and <span class="math notranslate nohighlight">\(\sigma_{i}\)</span> are the log-parameters on either side of an interface, <span class="math notranslate nohighlight">\(h_{i}\)</span> is the log-thickness of the ith layer, and <span class="math notranslate nohighlight">\(h_{min}\)</span> is the minimum log thickness defined by</p>
<div class="math notranslate nohighlight" id="equation-minthickness">
<span class="eqno">(9)<a class="headerlink" href="#equation-minthickness" title="Permalink to this equation"></a></span>\[h_{min} = \frac{z_{max} - z_{min}}{2 k_{max}}\]</div>
<p>where <span class="math notranslate nohighlight">\(k_{max}\)</span> is a maximum number of layers, set to be far greater than the expected final solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sPar</strong> (<em>bool</em>) – Evaluate the prior on the parameters <a class="reference internal" href="Model_.html#equation-parameter">(8)</a> in the final probability</p></li>
<li><p><strong>sGradient</strong> (<em>bool</em>) – Evaluate the prior on the parameter gradient <a class="reference internal" href="Model_.html#equation-gradient">(9)</a> in the final probability</p></li>
<li><p><strong>components</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return all components used in the final probability as well as the final probability</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>probability</strong> (<em>numpy.float64</em>) – The probability</p></li>
<li><p><strong>components</strong> (<em>array_like, optional</em>) – Return the components of the probability, i.e. the individually evaluated priors as a second return argument if comonents=True on input.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.proposalProbabilities">
<span class="sig-name descname"><span class="pre">proposalProbabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">remappedModel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datapoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.proposalProbabilities" title="Permalink to this definition"></a></dt>
<dd><p>Return the forward and reverse proposal probabilities for the model</p>
<p>Returns the denominator and numerator for the model’s components of the proposal ratio.</p>
<div class="math notranslate nohighlight" id="equation-proposal-numerator">
<span class="eqno">(10)<a class="headerlink" href="#equation-proposal-numerator" title="Permalink to this equation"></a></span>\[q(k, \boldsymbol{z} | \boldsymbol{m}^{'})\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-proposal-denominator">
<span class="eqno">(11)<a class="headerlink" href="#equation-proposal-denominator" title="Permalink to this equation"></a></span>\[q(k^{'}, \boldsymbol{z}^{'} | \boldsymbol{m})\]</div>
<p>Each component is dependent on the event that was chosen during perturbation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>remappedModel</strong> (<em>geobipy.Model1D</em>) – The current model, remapped onto the dimension of self.</p></li>
<li><p><strong>datapoint</strong> (<em>geobipy.DataPoint</em>) – The perturbed datapoint that was used to generate self.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>forward</strong> (<em>float</em>) – The forward proposal probability</p></li>
<li><p><strong>reverse</strong> (<em>float</em>) – The reverse proposal probability</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.setProposals">
<span class="sig-name descname"><span class="pre">setProposals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">probabilities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameterProposal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.setProposals" title="Permalink to this definition"></a></dt>
<dd><p>Setup the proposals of a 1D model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>halfSpaceValue</strong> (<em>float</em>) – Value of the parameter for the halfspace.</p></li>
<li><p><strong>probabilities</strong> (<em>array_like</em>) – Probability of birth, death, perturb, and no change for the model
e.g. pWheel = [0.5, 0.25, 0.15, 0.1]</p></li>
<li><p><strong>parameterProposal</strong> (<em>geobipy.Distribution</em>) – The proposal distribution for the parameter.</p></li>
<li><p><strong>prng</strong> (<em>numpy.random.RandomState</em><em>(</em><em>)</em><em>, </em><em>optional</em>) – Random number generator, if none is given, will use numpy’s global generator.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">geobipy.Model1D.perturb</span></code></dt><dd><p>For a description of the perturbation cycle.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.set_priors">
<span class="sig-name descname"><span class="pre">set_priors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">halfSpaceValue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_edge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_edge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cells</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameterPrior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradientPrior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameterLimits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dzVariance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.set_priors" title="Permalink to this definition"></a></dt>
<dd><p>Setup the priors of a 1D model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>halfSpaceValue</strong> (<em>float</em>) – Value of the parameter for the halfspace.</p></li>
<li><p><strong>min_edge</strong> (<em>float64</em>) – Minimum depth possible for the model</p></li>
<li><p><strong>max_edge</strong> (<em>float64</em>) – Maximum depth possible for the model</p></li>
<li><p><strong>max_cells</strong> (<em>int</em>) – Maximum number of layers allowable in the model</p></li>
<li><p><strong>parameterPrior</strong> (<em>bool</em>) – Sets a prior on the parameter values</p></li>
<li><p><strong>gradientPrior</strong> (<em>bool</em>) – Sets a prior on the gradient of the parameter values</p></li>
<li><p><strong>parameterLimits</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Length 2 array with the bounds on the parameter values to impose.</p></li>
<li><p><strong>min_width</strong> (<em>float64</em><em>, </em><em>optional</em>) – Minimum thickness of any layer. If min_width = None, min_width is computed from min_edge, max_edge, and max_cells (recommended).</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>optional</em>) – Tuning parameter used in the std of the parameter prior.</p></li>
<li><p><strong>prng</strong> (<em>numpy.random.RandomState</em><em>(</em><em>)</em><em>, </em><em>optional</em>) – Random number generator, if none is given, will use numpy’s global generator.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">geobipy.Model1D.perturb</span></code></dt><dd><p>For a description of the perturbation cycle.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.summary">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">summary</span></span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.summary" title="Permalink to this definition"></a></dt>
<dd><p>Write a summary of the 1D model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.unperturb">
<span class="sig-name descname"><span class="pre">unperturb</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.unperturb" title="Permalink to this definition"></a></dt>
<dd><p>After a model has had its structure perturbed, remap the model back its previous state. Used for the reversible jump McMC step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.update_parameter_posterior">
<span class="sig-name descname"><span class="pre">update_parameter_posterior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.update_parameter_posterior" title="Permalink to this definition"></a></dt>
<dd><p>Imposes a model’s parameters with depth onto a 2D Hitmap.</p>
<p>The cells that the parameter-depth profile passes through are accumulated by 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Hitmap</strong> (<em>geobipy.Hitmap</em>) – The hitmap to add to</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.update_posteriors">
<span class="sig-name descname"><span class="pre">update_posteriors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minimumRatio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.update_posteriors" title="Permalink to this definition"></a></dt>
<dd><p>Update any attached posterior distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>minimumRatio</strong> (<em>float</em>) – Only update the depth posterior if the layer parameter ratio
is greater than this number.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geobipy.src.classes.model.Model1D.Model1D.writeHdf">
<span class="sig-name descname"><span class="pre">writeHdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h5obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">withPosterior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.writeHdf" title="Permalink to this definition"></a></dt>
<dd><p>Create the Metadata for a Model1D in a HDF file</p>
<p>Creates a new group in a HDF file under h5obj.
A nested heirarchy will be created.
This method can be used in an MPI parallel environment, if so however, a) the hdf file must have been opened with the mpio driver,
and b) createHdf must be called collectively, i.e., called by every core in the MPI communicator that was used to open the file.
In order to create large amounts of empty space before writing to it in parallel, the nRepeats parameter will extend the memory
in the first dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h5obj</strong> (<em>h5py._hl.files.File</em><em> or </em><em>h5py._hl.group.Group</em>) – A HDF file or group object to create the contents in.</p></li>
<li><p><strong>name</strong> (<em>str</em>) – The name of the group to create.</p></li>
<li><p><strong>fillvalue</strong> (<em>number</em><em>, </em><em>optional</em>) – Initializes the memory in file with the fill value</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method can be used in serial and MPI. As an example in MPI.
Given 10 MPI ranks, each with a 10 length array, it is faster to create a 10x10 empty array, and have each rank write its row.
Rather than creating 10 separate length 10 arrays because the overhead when creating the file metadata can become very
cumbersome if done too many times.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">geobipy</span> <span class="kn">import</span> <span class="n">Model1D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpi4py</span> <span class="kn">import</span> <span class="n">MPI</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">world</span> <span class="o">=</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a holder for models in memory with more layers than you will expect.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp</span> <span class="o">=</span> <span class="n">Model1D</span><span class="p">(</span><span class="n">nCells</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># This is a collective open of data in the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s1">&#39;mpio&#39;</span><span class="p">,</span><span class="n">comm</span><span class="o">=</span><span class="n">world</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Collective creation of space(padded by number of mpi ranks)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp</span><span class="o">.</span><span class="n">createHdf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="n">nRepeats</span><span class="o">=</span><span class="n">world</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">world</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># In a non collective region, we can write to different sections of x in the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fake a non collective region</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">noncollectivewrite</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Each rank carries out this code, but it&#39;s not collective.</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">model</span><span class="o">.</span><span class="n">writeHdf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;models&#39;</span><span class="p">,</span>  <span class="n">index</span><span class="o">=</span><span class="n">world</span><span class="o">.</span><span class="n">rank</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noncollectivewrite</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">world</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">world</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Model_.html" class="btn btn-neutral float-left" title="Model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../pointcloud/pointcloud.html" class="btn btn-neutral float-right" title="Pointcloud classes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright None.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>