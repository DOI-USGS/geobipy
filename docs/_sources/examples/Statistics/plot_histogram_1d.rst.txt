
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/Statistics/plot_histogram_1d.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_Statistics_plot_histogram_1d.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_Statistics_plot_histogram_1d.py:


Histogram 1D
------------

This histogram class allows efficient updating of histograms, plotting and
saving as HDF5

.. GENERATED FROM PYTHON SOURCE LINES 10-17

.. code-block:: Python

    from geobipy.src.classes.mesh.RectilinearMesh1D import RectilinearMesh1D
    import h5py
    from geobipy import StatArray
    from geobipy import Histogram
    import numpy as np
    import matplotlib.pyplot as plt








.. GENERATED FROM PYTHON SOURCE LINES 18-20

Histogram with regular bins
+++++++++++++++++++++++++++

.. GENERATED FROM PYTHON SOURCE LINES 20-24

.. code-block:: Python


    # Create regularly spaced bins
    mesh = RectilinearMesh1D(edges=StatArray(np.linspace(-3.0, 3.0, 101), 'bins', 'm'))








.. GENERATED FROM PYTHON SOURCE LINES 25-26

Set the histogram using the bins, and update

.. GENERATED FROM PYTHON SOURCE LINES 26-28

.. code-block:: Python

    H = Histogram(mesh=mesh)








.. GENERATED FROM PYTHON SOURCE LINES 29-30

We can update the histogram with some new values

.. GENERATED FROM PYTHON SOURCE LINES 30-43

.. code-block:: Python

    H.update(np.random.randn(1000), trim=True)

    # Plot the histogram
    plt.figure()
    plt.subplot(221)
    _ = H.plot()
    plt.subplot(222)
    _ = H.pdf.bar()
    plt.subplot(223)
    H.pmf.bar()
    plt.subplot(224)
    H.cdf().bar()




.. image-sg:: /examples/Statistics/images/sphx_glr_plot_histogram_1d_001.png
   :alt: plot histogram 1d
   :srcset: /examples/Statistics/images/sphx_glr_plot_histogram_1d_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <Axes: xlabel='bins (m)', ylabel='Cumulative Density Function'>



.. GENERATED FROM PYTHON SOURCE LINES 44-45

Get the median, and 95% confidence values

.. GENERATED FROM PYTHON SOURCE LINES 45-53

.. code-block:: Python

    print(H.credible_intervals(percent=95.0))

    plt.figure()
    H.plot()
    H.plotCredibleIntervals()
    H.plotMean()
    H.plotMedian()




.. image-sg:: /examples/Statistics/images/sphx_glr_plot_histogram_1d_002.png
   :alt: plot histogram 1d
   :srcset: /examples/Statistics/images/sphx_glr_plot_histogram_1d_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    (-0.030000000000000027, -1.95, 1.9499999999999997)




.. GENERATED FROM PYTHON SOURCE LINES 54-56

Histogram with irregular bins
+++++++++++++++++++++++++++++

.. GENERATED FROM PYTHON SOURCE LINES 56-61

.. code-block:: Python


    # Create irregularly spaced bins
    x = np.cumsum(np.arange(10, dtype=np.float64))
    irregularBins = np.hstack([-x[::-1], x[1:]])








.. GENERATED FROM PYTHON SOURCE LINES 62-63

Create a named StatArray

.. GENERATED FROM PYTHON SOURCE LINES 63-66

.. code-block:: Python

    edges = StatArray(irregularBins, 'irregular bins')
    mesh = RectilinearMesh1D(edges = edges)








.. GENERATED FROM PYTHON SOURCE LINES 67-68

Instantiate the histogram with bin edges

.. GENERATED FROM PYTHON SOURCE LINES 68-73

.. code-block:: Python

    H = Histogram(mesh=mesh)

    # Update the histogram
    H.update((np.random.randn(10000)*20.0) - 10.0)








.. GENERATED FROM PYTHON SOURCE LINES 74-75

Plot the histogram

.. GENERATED FROM PYTHON SOURCE LINES 75-87

.. code-block:: Python

    plt.figure()
    plt.subplot(211)
    _ = H.plot()
    plt.subplot(212)
    _ = H.plot(normalize=True)

    plt.figure()
    H.plot()
    H.plotCredibleIntervals()
    H.plotMean()
    H.plotMedian()




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /examples/Statistics/images/sphx_glr_plot_histogram_1d_003.png
         :alt: plot histogram 1d
         :srcset: /examples/Statistics/images/sphx_glr_plot_histogram_1d_003.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /examples/Statistics/images/sphx_glr_plot_histogram_1d_004.png
         :alt: plot histogram 1d
         :srcset: /examples/Statistics/images/sphx_glr_plot_histogram_1d_004.png
         :class: sphx-glr-multi-img





.. GENERATED FROM PYTHON SOURCE LINES 88-89

We can plot the histogram as a pcolor plot

.. GENERATED FROM PYTHON SOURCE LINES 89-92

.. code-block:: Python

    plt.figure()
    _ = H.pcolor(grid=True, transpose=True)




.. image-sg:: /examples/Statistics/images/sphx_glr_plot_histogram_1d_005.png
   :alt: plot histogram 1d
   :srcset: /examples/Statistics/images/sphx_glr_plot_histogram_1d_005.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 93-96

Histogram with linear space entries that are logged internally
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Create some bins spaced logarithmically

.. GENERATED FROM PYTHON SOURCE LINES 96-98

.. code-block:: Python

    mesh = RectilinearMesh1D(edges = StatArray(np.logspace(-5, 3), 'positive bins'), log=10)








.. GENERATED FROM PYTHON SOURCE LINES 99-100

Instantiate the Histogram with log=10

.. GENERATED FROM PYTHON SOURCE LINES 100-102

.. code-block:: Python

    H = Histogram(mesh)








.. GENERATED FROM PYTHON SOURCE LINES 103-104

The update takes in the numbers in linear space and takes their log=10

.. GENERATED FROM PYTHON SOURCE LINES 104-106

.. code-block:: Python

    H.update(10.0**(np.random.randn(1000)*2.0), trim=True)








.. GENERATED FROM PYTHON SOURCE LINES 107-122

.. code-block:: Python

    plt.figure()
    plt.subplot(211)
    _ = H.plot()

    import h5py
    with h5py.File('h1d.h5', 'w') as f:
        H.toHdf(f, 'h1d')

    with h5py.File('h1d.h5', 'r') as f:
        H1 = Histogram.fromHdf(f['h1d'])

    plt.subplot(212)
    _ = H1.plot()





.. image-sg:: /examples/Statistics/images/sphx_glr_plot_histogram_1d_006.png
   :alt: plot histogram 1d
   :srcset: /examples/Statistics/images/sphx_glr_plot_histogram_1d_006.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 123-124

.. code-block:: Python

    mesh = RectilinearMesh1D(edges=StatArray(np.linspace(-3.0, 3.0, 101), 'bins', 'm'))







.. GENERATED FROM PYTHON SOURCE LINES 125-126

Set the histogram using the bins, and update

.. GENERATED FROM PYTHON SOURCE LINES 126-128

.. code-block:: Python

    H = Histogram(mesh=mesh)








.. GENERATED FROM PYTHON SOURCE LINES 129-130

We can update the histogram with some new values

.. GENERATED FROM PYTHON SOURCE LINES 130-156

.. code-block:: Python

    H.update(np.random.randn(1000), trim=True)

    import h5py
    with h5py.File('h1d.h5', 'w') as f:
        H.createHdf(f, 'h1d', add_axis=StatArray(np.arange(3.0), "Name", "Units"))
        H.writeHdf(f, 'h1d', index=0)
        H.update(np.random.randn(1000), trim=True)
        H.writeHdf(f, 'h1d', index=1)
        H.update(np.random.randn(1000), trim=True)
        H.writeHdf(f, 'h1d', index=2)

    with h5py.File('h1d.h5', 'r') as f:
        H1 = Histogram.fromHdf(f['h1d'])
        H2 = Histogram.fromHdf(f['h1d'], index=0)
        H3 = Histogram.fromHdf(f['h1d'], index=1)
        H4 = Histogram.fromHdf(f['h1d'], index=2)


    print(H4.summary)

    # plt.figure()
    # plt.subplot(211)
    # _ = H1.plot()
    # plt.subplot(212)
    # _ = H4.plot()

    plt.show()



.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Histogram:
    mesh:
    |   RectilinearMesh1D
    |   Number of Cells:
    |   |   100
    |   Cell Centres:
    |   |   Name: bins (m) 0x7fbfa200e340
    |   |   Shape: (100,)
    |   |   Values: [-2.97 -2.91 -2.85 ...  2.85  2.91  2.97]
    |   |   Min: -2.9699999999999998
    |   |   Max: 2.9699999999999998
    |   |   has_posterior: False
    |   
    |   Cell Edges:
    |   |   Name: bins (m) 0x7fbfa200d6c0
    |   |   Shape: (101,)
    |   |   Values: [-3.   -2.94 -2.88 ...  2.88  2.94  3.  ]
    |   |   Min: -3.0
    |   |   Max: 3.0
    |   |   has_posterior: False
    |   
    |   log:
    |   |   None
    |   relativeTo:
    |   |   Name:  0x7fbfa1fb06c0
    |   |   Shape: (1,)
    |   |   Values: [0.]
    |   |   Min: 0.0
    |   |   Max: 0.0
    |   |   has_posterior: False
    |   
    values:
    |   Name: Frequency 0x7fbfa200f2c0
    |   Shape: (100,)
    |   Values: [3 2 3 ... 0 2 1]
    |   Min: 0
    |   Max: 87
    |   has_posterior: False







.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 1.293 seconds)


.. _sphx_glr_download_examples_Statistics_plot_histogram_1d.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_histogram_1d.ipynb <plot_histogram_1d.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_histogram_1d.py <plot_histogram_1d.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
